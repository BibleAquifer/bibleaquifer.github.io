<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified Catalog - Aquifer Bible Resources</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <div>
                <h1>Unified Catalog</h1>
                <p class="subtitle">Browse Aquifer Bible Resources by Type and Language</p>
            </div>
            <nav class="header-nav">
                <a href="index.html" class="catalog-link">Home</a>
                <a href="https://github.com/BibleAquifer" target="_blank" class="catalog-link">Github Org</a>
            </nav>
        </div>
    </header>

    <nav class="breadcrumb">
        <div class="container">
            <a href="index.html">Home</a> &gt; Catalog
        </div>
    </nav>

    <main class="catalog-layout">
        <aside class="catalog-sidebar">
            <section id="catalog-controls">
                <h2>Filters</h2>
                <div class="control-group">
                    <label for="resource-select">Select Resource:</label>
                    <select id="resource-select">
                        <option value="">Select a resource...</option>
                        <option value="AquiferOpenBibleDictionary">Open Bible Dictionary</option>
                        <option value="BiblicaStudyNotes">Study Notes (Biblica)</option>
                        <option value="UWTranslationNotes">Translation Notes (unfoldingWord)</option>
                        <option value="UWTranslationWords">Translation Words (unfoldingWord)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="language-select">Select Language:</label>
                    <select id="language-select">
                        <option value="">Select a resource first</option>
                    </select>
                </div>
            </section>
        </aside>

        <div class="catalog-content">
            <section id="resource-info" class="hidden">
                <div id="resource-metadata"></div>
            </section>

            <section id="content-viewer" class="hidden">
                <h2>Resource Details</h2>
                <div id="content-display"></div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Mission Mutual. Open Biblical Resources.</p>
            <p><a href="https://github.com/BibleAquifer" target="_blank">GitHub Org</a> | <a href="https://github.com/BibleAquifer/docs" target="_blank">Documentation</a></p>
        </div>
    </footer>

    <script>
// Resource data embedded from YAML
const RESOURCES_DATA = {
  "UWTranslationNotes": {
    "name": "UWTranslationNotes",
    "title": "Translation Notes (unfoldingWord)",
    "description": "Translation notes for Bible translators",
    "url": "https://github.com/BibleAquifer/UWTranslationNotes",
    "languages": {
      "eng": {
        "code": "eng",
        "name": "English",
        "title": "unfoldingWord\u00ae Translation Notes",
        "version": "1.0.0",
        "resource_type": "Translation Guide",
        "content_type": "Html",
        "language": "eng",
        "citation": {
          "title": "unfoldingWord\u00ae Translation Notes",
          "copyright_dates": "2022",
          "copyright_holder": "unfoldingWord",
          "license_name": "CC BY-SA 4.0 license"
        },
        "has_json": true,
        "has_md": true,
        "has_pdf": false,
        "has_docx": false
      },
      "spa": {
        "code": "spa",
        "name": "Spanish",
        "title": "unfoldingWord\u00ae Translation Notes",
        "version": "1.0.0",
        "resource_type": "Translation Guide",
        "content_type": "Html",
        "language": "spa",
        "citation": {
          "title": "unfoldingWord\u00ae Translation Notes",
          "copyright_dates": "2022",
          "copyright_holder": "unfoldingWord",
          "license_name": "CC BY-SA 4.0 license"
        },
        "has_json": true,
        "has_md": true,
        "has_pdf": false,
        "has_docx": false
      }
    }
  },
  "AquiferOpenBibleDictionary": {
    "name": "AquiferOpenBibleDictionary",
    "title": "Open Bible Dictionary",
    "description": "Comprehensive Bible dictionary",
    "url": "https://github.com/BibleAquifer/AquiferOpenBibleDictionary",
    "languages": {
      "eng": {
        "code": "eng",
        "name": "English",
        "title": "Open Bible Dictionary",
        "version": "2.0.0",
        "resource_type": "Dictionary",
        "content_type": "Html",
        "language": "eng",
        "citation": {
          "title": "Open Bible Dictionary",
          "copyright_dates": "2023",
          "copyright_holder": "BibleAquifer",
          "license_name": "CC BY 4.0"
        },
        "has_json": true,
        "has_md": true,
        "has_pdf": false,
        "has_docx": false
      }
    }
  },
  "UWTranslationWords": {
    "name": "UWTranslationWords",
    "title": "Translation Words (unfoldingWord)",
    "description": "Key biblical terms with definitions",
    "url": "https://github.com/BibleAquifer/UWTranslationWords",
    "languages": {
      "eng": {
        "code": "eng",
        "name": "English",
        "title": "unfoldingWord\u00ae Translation Words",
        "version": "1.0.0",
        "resource_type": "Key Terms",
        "content_type": "Html",
        "language": "eng",
        "citation": {
          "title": "unfoldingWord\u00ae Translation Words",
          "copyright_dates": "2022",
          "copyright_holder": "unfoldingWord",
          "license_name": "CC BY-SA 4.0 license"
        },
        "has_json": true,
        "has_md": true,
        "has_pdf": false,
        "has_docx": false
      }
    }
  },
  "BiblicaStudyNotes": {
    "name": "BiblicaStudyNotes",
    "title": "Study Notes (Biblica)",
    "description": "Study notes from Biblica",
    "url": "https://github.com/BibleAquifer/BiblicaStudyNotes",
    "languages": {
      "eng": {
        "code": "eng",
        "name": "English",
        "title": "Study Notes (Biblica)",
        "version": "1.0.0",
        "resource_type": "Study Notes",
        "content_type": "Html",
        "language": "eng",
        "citation": {
          "title": "Study Notes (Biblica)",
          "copyright_dates": "2024",
          "copyright_holder": "Biblica",
          "license_name": "CC BY-SA 4.0"
        },
        "has_json": true,
        "has_md": true,
        "has_pdf": true,
        "has_docx": true
      }
    }
  }
};
const ORG_NAME = 'BibleAquifer';

// DOM elements
const resourceSelect = document.getElementById('resource-select');
const languageSelect = document.getElementById('language-select');
const resourceMetadataDiv = document.getElementById('resource-metadata');
const contentDisplayDiv = document.getElementById('content-display');
const resourceInfoSection = document.getElementById('resource-info');
const contentViewerSection = document.getElementById('content-viewer');

// State
let selectedResource = null;
let selectedLanguage = null;

// Setup event listeners
resourceSelect.addEventListener('change', handleResourceChange);
languageSelect.addEventListener('change', handleLanguageChange);

// Handle resource selection
function handleResourceChange() {
    const resourceId = resourceSelect.value;
    
    if (!resourceId) {
        languageSelect.innerHTML = '<option value="">Select a resource first</option>';
        languageSelect.disabled = true;
        resourceMetadataDiv.innerHTML = '';
        contentDisplayDiv.innerHTML = '';
        resourceInfoSection.classList.add('hidden');
        contentViewerSection.classList.add('hidden');
        return;
    }
    
    selectedResource = RESOURCES_DATA[resourceId];
    
    // Populate language dropdown
    languageSelect.innerHTML = '<option value="">Select a language...</option>';
    
    const languages = Object.values(selectedResource.languages).sort((a, b) => 
        a.name.localeCompare(b.name)
    );
    
    const hasEng = languages.some(lang => lang.code === 'eng');
    
    languages.forEach(lang => {
        const option = document.createElement('option');
        option.value = lang.code;
        option.textContent = lang.name;
        if (lang.code === 'eng' && hasEng) {
            option.selected = true;
        }
        languageSelect.appendChild(option);
    });
    
    languageSelect.disabled = false;
    
    // Display resource info
    displayResourceInfo();
    
    // Auto-load English if available
    if (hasEng) {
        selectedLanguage = 'eng';
        displayLanguageMetadata();
    }
}

// Handle language selection
function handleLanguageChange() {
    selectedLanguage = languageSelect.value;
    
    if (!selectedLanguage) {
        contentDisplayDiv.innerHTML = '';
        contentViewerSection.classList.add('hidden');
        return;
    }
    
    displayLanguageMetadata();
}

// Display resource information
function displayResourceInfo() {
    if (!selectedResource) return;
    
    resourceMetadataDiv.innerHTML = `
        <h3>${selectedResource.title}</h3>
        <p>${selectedResource.description || 'No description available'}</p>
        <p><a href="${selectedResource.url}" target="_blank">View on GitHub</a></p>
    `;
    
    resourceInfoSection.classList.remove('hidden');
}

// Display language metadata
function displayLanguageMetadata() {
    if (!selectedResource || !selectedLanguage) return;
    
    const langData = selectedResource.languages[selectedLanguage];
    if (!langData) {
        contentDisplayDiv.innerHTML = '<p>No metadata available for this language.</p>';
        return;
    }
    
    let html = '';
    
    // Display citation if available
    if (langData.citation && langData.citation.title) {
        html += '<h3>Citation</h3>';
        html += '<p class="citation">';
        html += `<em>${langData.citation.title}</em>`;
        
        if (langData.citation.copyright_holder) {
            html += `. &copy; ${langData.citation.copyright_dates || ''} ${langData.citation.copyright_holder}`;
        }
        
        if (langData.citation.license_name) {
            html += `. Licensed under ${langData.citation.license_name}`;
        }
        
        html += '.</p>';
        
        // Add adaptation notice if available
        if (langData.citation.adaptation_notice) {
            html += `<div class="adaptation-notice">${langData.citation.adaptation_notice}</div>`;
        }
        
        html += '<hr style="margin: 1.5rem 0;">';
    }
    
    // Display key metadata
    html += '<h3>Resource Information</h3>';
    html += '<div class="metadata-grid">';
    
    const metadataFields = [
        { label: 'Title', value: langData.title },
        { label: 'Language', value: langData.language },
        { label: 'Version', value: langData.version },
        { label: 'Type', value: langData.resource_type },
        { label: 'Content Type', value: langData.content_type }
    ];
    
    metadataFields.forEach(field => {
        if (field.value) {
            html += `
                <div class="metadata-label">${field.label}:</div>
                <div class="metadata-value">${field.value}</div>
            `;
        }
    });
    
    html += '</div>';
    
    // Add download links
    html += '<hr style="margin: 1.5rem 0;">';
    html += '<h3>Access Resource</h3>';
    html += '<p>Browse or download this resource:</p>';
    html += '<ul class="download-list">';
    
    // Dynamically check and add links for all available formats
    const formats = [
        { key: 'has_json', name: 'JSON', label: 'Browse JSON files' },
        { key: 'has_md', name: 'Markdown', label: 'Browse Markdown files' },
        { key: 'has_pdf', name: 'PDF', label: 'Browse PDF files' },
        { key: 'has_docx', name: 'DOCX', label: 'Browse DOCX files' },
        { key: 'has_usx', name: 'USX', label: 'Browse USX files' },
        { key: 'has_usfm', name: 'USFM', label: 'Browse USFM files' },
        { key: 'has_audio', name: 'audio', label: 'Browse audio timings' }
        
    ];
    
    formats.forEach(format => {
        if (langData[format.key]) {
            const dirName = format.key.replace('has_', '');
            html += `<li><a href="https://github.com/${ORG_NAME}/${selectedResource.name}/tree/main/${selectedLanguage}/${dirName}" target="_blank">${format.label}</a></li>`;
        }
    });
    
    html += `<li><a href="https://github.com/${ORG_NAME}/${selectedResource.name}/releases/latest" target="_blank">Download latest release</a></li>`;
    html += '</ul>';
    
    contentDisplayDiv.innerHTML = html;
    contentViewerSection.classList.remove('hidden');
}
    </script>
</body>
</html>